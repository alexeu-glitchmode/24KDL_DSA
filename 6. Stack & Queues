// Bài 1
#include <stdio.h>
#include <string.h>

#define MAX 1000

typedef struct {
    char a[MAX];
    int top;
} Stack;

void init(Stack *s){
    s->top = -1;
}

int isEmpty(Stack* s){
    return s->top == -1;
}

int isFull(Stack* s){
    return s->top == MAX - 1;
}

void push(Stack* s, char value){
    s->top++;
    s->a[s->top] = value;
}

char pop(Stack* s){
    char data = s->a[s->top];
    s->top--;
    return data;
}

void reverseByArray(char str[]){
    int left = 0;
    int right = strlen(str) - 1;
    char temp;

    while(left < right){
        temp = str[left];
        str[left] = str[right];
        str[right] = temp;
        left++;
        right--;
    }
}

void reverseByStack(char str[]){
    Stack s;
    init(&s);

    int len = strlen(str);
    for(int i = 0; i < len; i++){
        push(&s, str[i]);
    }

    for(int i = 0; i < len; i++){
        str[i] = pop(&s);
    }
}

int main(){
    char str1[MAX], str2[MAX];

    printf("Nhap chuoi: ");
    fgets(str1, MAX, stdin);
    str1[strcspn(str1, "\n")] = '\0';

    strcpy(str2, str1); 

    reverseByArray(str1);
    reverseByStack(str2);

    printf("Dao chuoi (Mang):  %s\n", str1);
    printf("Dao chuoi (Stack): %s\n", str2);

    return 0;
}


//Bài 2
#include <stdio.h>
#include <string.h>

#define MAX 1000

typedef struct {
    char bracket;
    int pos;
} Item;

typedef struct {
    Item a[MAX];
    int top;
} Stack;

// Khoi tao stack
void init(Stack *s){
    s->top = -1;
}

// Kiem tra rong
int isEmpty(Stack *s){
    return s->top == -1;
}

// Push
void push(Stack *s, char c, int pos){
    s->top++;
    s->a[s->top].bracket = c;
    s->a[s->top].pos = pos;
}

// Pop
Item pop(Stack *s){
    Item temp = s->a[s->top];
    s->top--;
    return temp;
}

// Kiem tra cap ngoac hop le
int isMatching(char open, char close){
    if(open == '(' && close == ')') return 1;
    if(open == '[' && close == ']') return 1;
    if(open == '{' && close == '}') return 1;
    return 0;
}

// Tim ngoac dong dung voi ngoac mo
char getCorrectClose(char open){
    if(open == '(') return ')';
    if(open == '[') return ']';
    if(open == '{') return '}';
    return '?';
}

int main(){
    char expr[MAX];
    Stack s;
    init(&s);

    printf("Nhap bieu thuc: ");
    fgets(expr, MAX, stdin);
    expr[strcspn(expr, "\n")] = '\0';

    int i;
    int error = 0;

    for(i = 0; i < strlen(expr); i++){
        char c = expr[i];

        // Ngoac mo
        if(c == '(' || c == '[' || c == '{'){
            push(&s, c, i);
        }
        // Ngoac dong
        else if(c == ')' || c == ']' || c == '}'){
            Item topItem = pop(&s);

            if(!isMatching(topItem.bracket, c)){
                printf("\n Error at %d\n", i);
                printf("   Ngoac mo: %c (vi tri %d)\n", topItem.bracket, topItem.pos);
                printf("   Ngoac dong: %c\n", c);
                printf("Sua: thay '%c' bang '%c'\n",
                       c, getCorrectClose(topItem.bracket));
                error = 1;
                break;
            }
        }
    }

    if(!error){
        printf("\n Bieu thuc hop le ve dau ngoac.\n");
    }

    return 0;
}


//Bài 4
#include <stdio.h>
#define MAX 10

typedef struct {
    int head, tail;
    int a[MAX];
} Queue;

void init(Queue* q) {
    q->head = 0;
    q->tail = -1;
}

int isEmpty(Queue *q){
    if(q->head == -1 || q->head == q->tail + 1)
        return 1;
    return 0;
}

int isFull(Queue *q){
    if (q->tail == MAX - 1)
        return 1;
    return 0;
}
void put(Queue* q, int value){
    q->tail++;
    q->a[q->tail] = value;
}
int get(Queue* q){
    int data = q->a[q->head];
    q->head++;
    return data;
}
void displayQueue(Queue* q){
    if(isEmpty(q)){
        printf("Queue is empty");
        return;
    }
    for(int i = q->head; i <= q->tail; i++){
        printf("%d ", q->a[i]);
    }
}
void cancelRegistration(Queue* q, int user){
    if(isEmpty(q)){
        printf("Queue is empty\n");
        return;
    }

    int found = 0;
    for(int i = q->head; i <= q->tail; i++){
        if(q->a[i] == user){
            found = 1;
            // dich trai
            for(int j = i; j < q->tail; j++){
                q->a[j] = q->a[j + 1];
            }
            q->tail--;
            printf("Da huy dang ky nguoi dung %d\n", user);
            break;
        }
    }

    if(!found){
        printf("Khong tim thay nguoi dung %d\n", user);
    }
}

int main() {
    Queue q;
    init(&q);

    printf("Dang ky nguoi dung:\n");
    put(&q, 101);
    put(&q, 102);
    put(&q, 103);
    put(&q, 104);

    displayQueue(&q);
    printf("\n");

    printf("\nNguoi dang ky som nhat: %d\n", get(&q));
    displayQueue(&q);
    printf("\n");

    printf("\nHuy dang ky nguoi dung 103\n");
    cancelRegistration(&q, 103);
    displayQueue(&q);
    printf("\n");

    printf("\nDang ky nguoi dung 105\n");
    put(&q, 105);
    displayQueue(&q);
    printf("\n");

    return 0;
}

